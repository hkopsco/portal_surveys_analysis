---
title: "Portal_Survey"
author: "Kopsco"
date: "3/29/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



```{r }
library(tidyverse)
library(dbplyr)
library(ggplot2)

download.file("https://ndownloader.figshare.com/files/2292169",
              "data/portal_data_joined.csv")
read_csv("data/portal_data_joined.csv")
surveys <- read_csv("data/portal_data_joined.csv")
```


```{r}
#Comparison of mean weight among species

surveys_mw <- surveys %>%
    filter(!is.na(weight)) %>%
    group_by(genus, species) %>%
    summarize(mean_weight = mean(weight))
surveys_mw
```

```{r}
#Comparison of mean weight of all species over time

surveys_mwy <- surveys %>%
    filter(!is.na(weight)) %>%
    group_by(genus, species, year) %>%
    summarize(mean_weight = mean(weight))
surveys_mwy
```

```{r}
#Plot of mean species weights 
ggplot(data = surveys_mwy, aes(genus, species, mean_weight))+  
  geom_jitter(aes(color=as.factor(genus)))+ geom_boxplot() + geom_point()
```

```{r}
#Student's t test comparing male and female weights
t.test(surveys$sex, surveys$weight)
```

##=== Eren's part

#Avarage weight per species

```{r include=FALSE}

clean_weight <- surveys %>% filter(!is.na(weight))

all_weights <- clean_weight %>% select(weight, species_id) %>% group_by(species_id)

p1 <- ggplot(all_weights, aes(x=species_id, y=weight, col = species_id)) + geom_jitter(alpha=.1,aes(color=as.factor(species_id))) + geom_boxplot() + labs(title="Mean weights per species",x="Species ID", y = "Weight") + theme_minimal()

p1

# summarise the weights

mean_weights_per_species <- clean_weight %>% select(weight, species_id) %>% group_by(species_id) %>% summarise(mean_weight = round(mean(weight),digits = 2))

```

